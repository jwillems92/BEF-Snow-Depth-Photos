mutate(Date = paste(Month, Day, Year, sep="/"))
exif_dat %>%
mutate(Date = mdy(paste(Month, Day, Year, sep="/")))
exif_dat %>%
mutate(Date = mdy(paste(Month, Day, Year, sep="/"))) %>%
pull(Date)
date_vec <- exif_dat %>%
mutate(Date = mdy(paste(Month, Day, Year, sep="/"))) %>%
pull(Date)
getSunlightTimes(date = date_vec, lat = 44.0639, lon = -71.2874)
getSunlightTimes(date = date_vec, lat = 44, lon = -71)
getSunlightTimes(date = date_vec, lat = 44, lon = -71, keep = c("sunrise", "sunset"))
getSunlightTimes(date = date_vec, lat = 44, lon = -71,
keep = c("sunrise", "sunset"),
tz = "ET")
getSunlightTimes(date = date_vec, lat = 44, lon = -71,
keep = c("sunrise", "sunset"),
tz = "America/New_York")
getSunlightTimes(date = date_vec, lat = 44.0639, lon = -71.2874,
keep = c("sunrise", "sunset"),
tz = "America/New_York")
getSunlightTimes(date = date_vec, lat = 44.0639, lon = -71.2874,
keep = c("sunrise"),
tz = "America/New_York") %>%
select(date, sunrise)
sunrise_times <- getSunlightTimes(date = date_vec, lat = 44.0639, lon = -71.2874,
keep = c("sunrise"),
tz = "America/New_York") %>%
select(date, sunrise)
left_join(exif_dat, sunrise_times)
left_join(exif_dat, sunrise_times, by = c(Date = date))
left_join(exif_dat, sunrise_times, by = c("Date" = "date"))
exif_dat
# Separate Date & Time columns, save file of metadata as csv
exif_dat <- exif_dat %>%
select(SourceFile, FileModifyDate) %>%
separate(col = "FileModifyDate",           # Split col into Date & Time cols
into = c("Date", "Time"),
sep = " ") %>%
separate(col = "Date",                     # Split Date col into M, D, Y cols
into = c("Year", "Month", "Day"),
sep = ":") %>%
separate(col = "Time",                     # Split time col
into = c("Time", NA),
sep = "-") %>%
mutate(Date = mdy(paste(Month, Day, Year, sep="/")))
knitr::opts_chunk$set(echo = TRUE)
library(exifr)
library(tidyverse)
library(suncalc)
library(lubridate)
# Set WD to main folder containing sub-folders for each year & month
# Pull in list of all images
image_files <- list.files(path = "Snow Photos",
pattern = "*.jpg",
recursive = TRUE,
full.names = TRUE)
# Extract EXIF data
exif_dat <- read_exif(image_files, recursive = FALSE)
# Separate Date & Time columns, save file of metadata as csv
file_dat <- exif_dat %>%
select(SourceFile, FileModifyDate) %>%
separate(col = "FileModifyDate",           # Split col into Date & Time cols
into = c("Date", "Time"),
sep = " ") %>%
separate(col = "Date",                     # Split Date col into M, D, Y cols
into = c("Year", "Month", "Day"),
sep = ":") %>%
separate(col = "Time",                     # Split time col
into = c("Time", NA),
sep = "-") %>%
mutate(Date = mdy(paste(Month, Day, Year, sep="/")))
date_vec <- file_dat %>% pull(Date)
sunrise_times <- getSunlightTimes(date = date_vec, lat = 44.0639, lon = -71.2874,
keep = c("sunrise"),
tz = "America/New_York") %>%
select(date, sunrise)
left_join(file_dat, sunrise_times, by = c("Date" = "date"))
file_dat
sunrise_times
file_dat %>% pull(Date) %>% unique(Date)
file_dat
file_dat %>%
group_by(Date) %>%
summarise(Time = first(Time)) %>%
ungroup()
date_vec <- file_dat %>%
group_by(Date) %>%
summarise(Time = first(Time)) %>%
ungroup() %>%
pull(Date)
date_vec
sunrise_times <- getSunlightTimes(date = date_vec, lat = 44.0639, lon = -71.2874,
keep = c("sunrise"),
tz = "America/New_York") %>%
select(date, sunrise)
left_join(file_dat, sunrise_times, by = c("Date" = "date"))
joined_df <- left_join(file_dat, sunrise_times, by = c("Date" = "date"))
joined_df
joined_df %>%
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S"))
joined_df %>%
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
mutate(TimeAfterSunrise = difftime(PhotoTime, sunrise, units="hours"))
joined_df %>%
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours")))
joined_df %>%
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
filter(TimeAfterSunrise > 0 & TimeAfterSunrise <= 1)
joined_df %>%
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
filter(TimeAfterSunrise > 0 & TimeAfterSunrise <= 0.5)
joined_df %>%
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
filter(TimeAfterSunrise > 0 & TimeAfterSunrise <= 0.5) %>%
select(SourceFile, Year, Month, Day, Time)
final_df <- joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise > 0 & TimeAfterSunrise <= 0.5) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Year, Month, Day, Time)
final_df
final_df
final_df %>% pull(SourceFile)
file_names <- final_df %>% pull(SourceFile)
file_names <- final_df %>% pull(SourceFile)
for(index in file_names){
jpeg(filename = SourceFile in index)
file_names <- final_df %>% pull(SourceFile)
for(index in file_names){
jpeg(filename == SourceFile in index)
file_names <- final_df %>% pull(SourceFile)
for(index in file_names){
jpeg(index)
data_path <- "C:/Users/jswil/Documents/R/PROJECTS/PhD/BEF Snow Depth Photos/Subsetted Photos/"
}
file_names <- final_df %>% pull(SourceFile)
for(index in file_names){
jpeg(paste0("C:/Users/jswil/Documents/R/PROJECTS/PhD/BEF Snow Depth Photos/Subsetted Photos/SSP_",index,".jpg"))
# data_path <- "C:/Users/jswil/Documents/R/PROJECTS/PhD/BEF Snow Depth Photos/Subsetted Photos/"
}
final_df %>% pull(SourceFile) %>% list.files()
image_files
file_names
file_names <- final_df %>% pull(SourceFile)
list.files(file_names)
final_df
write.csv(file = "2020_Subsetted.csv", final_df)
knitr::opts_chunk$set(echo = TRUE)
library(exifr)
library(tidyverse)
library(suncalc)
library(lubridate)
# Set WD to main folder containing sub-folders for each year & month
# Pull in list of all images
image_files <- list.files(path = "Snow Photos",
pattern = "*.jpg",
recursive = TRUE,
full.names = TRUE)
# Extract EXIF data
exif_dat <- read_exif(image_files, recursive = FALSE)
# Separate Date & Time columns, save file of metadata as csv
file_dat <- exif_dat %>%
select(SourceFile, FileModifyDate) %>%
separate(col = "FileModifyDate",           # Split col into Date & Time cols
into = c("Date", "Time"),
sep = " ") %>%
separate(col = "Date",                     # Split Date col into M, D, Y cols
into = c("Year", "Month", "Day"),
sep = ":") %>%
separate(col = "Time",                     # Split time col
into = c("Time", NA),
sep = "-") %>%
mutate(Date = mdy(paste(Month, Day, Year, sep="/")))
date_vec <- file_dat %>%
group_by(Date) %>%                 # Likely a better way to do this...
summarise(Time = first(Time)) %>%
ungroup() %>%
pull(Date)
# Get sunrise times for all dates
sunrise_times <- getSunlightTimes(date = date_vec, lat = 44.0639, lon = -71.2874,
keep = c("sunrise"),
tz = "America/New_York") %>%
select(date, sunrise)
# Join sunrise times back to main exif data frame
joined_df <- left_join(file_dat, sunrise_times, by = c("Date" = "date"))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise > 0 & TimeAfterSunrise <= 0.5) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Year, Month, Day, Time)
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise > 0 & TimeAfterSunrise <= 0.5) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Year, Month, Day, Time) %>%
group_by(Date) %>%
summarise(SourceFile = first(SourceFile))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise > 0 & TimeAfterSunrise <= 0.5) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
group_by(Date) %>%
summarise(SourceFile = first(SourceFile))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise > 0 & TimeAfterSunrise <= 0.5) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time)
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise > 0 & TimeAfterSunrise <= 0.5) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Year = first(Year),
Month = first(Month),
Day = first(Day),
Time = first(Time))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Year = first(Year),
Month = first(Month),
Day = first(Day),
Time = first(Time))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise >= 0.5) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Year = first(Year),
Month = first(Month),
Day = first(Day),
Time = first(Time))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise >= 0) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Year = first(Year),
Month = first(Month),
Day = first(Day),
Time = first(Time))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Year = first(Year),
Month = first(Month),
Day = first(Day),
Time = first(Time))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
group_by(Date, SourceFile) %>%
summarise(Time = first(Time))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
group_by(Date, SourceFile) %>%
summarise(SourceFile = first(SourceFile),
Time = first(Time))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Time = first(Time))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time)
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Time = first(Time))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours")))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
filter(Month == 3 & Day == 01)
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
filter(Month = 3 & Day = 01)
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
filter(Month == 3)
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))
joined_df %>%
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours")))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
filter(Month == 03 & Day == 01)
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours")))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise >= 1 & TimeAfterSunrise <= 3)
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken <= 0.5 hours after sunrise
filter(TimeAfterSunrise >= 1 & TimeAfterSunrise <= 3) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Time = first(Time))
exif_dat
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken >= 1 hour after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
# Group by date to get only 1 photo per day
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Time = first(Time))             # This should give us just the first photo of the day
final_df <- joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken >= 1 hour after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
# Group by date to get only 1 photo per day
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Time = first(Time))            # This should give us just the first photo of the day
write.csv(file = "BEF Snow 2020 Subsetted.csv", final_df)
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken >= 1 hour after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
# Group by date to get only 1 photo per day
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Time = first(Time)) %>%             # This should give us just the first photo of the day
mutate(Year = year(Date),
Month = month(Date),
Day = day(Date))
joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken >= 1 hour after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
# Group by date to get only 1 photo per day
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Time = first(Time)) %>%             # This should give us just the first photo of the day
# Break Date column back up into components
mutate(Year = year(Date),
Month = month(Date),
Day = day(Date)) %>%
# Reselect final columns wanted in order
select(SourceFile, Year, Month, Day, Time)
final_df <- joined_df %>%
# Create datetime column
mutate(PhotoTime = as.POSIXct(paste(Date, Time), format="%Y-%m-%d %H:%M:%S")) %>%
# Calculate time difference between when photo was taken and sunrise
mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units="hours"))) %>%
# Filter for photos taken >= 1 hour after sunrise
filter(TimeAfterSunrise >= 1) %>%
# Select only columns needed for final spreadsheet
select(SourceFile, Date, Year, Month, Day, Time) %>%
# Group by date to get only 1 photo per day
group_by(Date) %>%
summarise(SourceFile = first(SourceFile),
Time = first(Time)) %>%             # This should give us just the first photo of the day
# Break Date column back up into components
mutate(Year = year(Date),
Month = month(Date),
Day = day(Date)) %>%
# Reselect final columns wanted in order
select(SourceFile, Year, Month, Day, Time)
write.csv(file = "BEF Snow 2020 Subsetted.csv", final_df, row.names = FALSE)
