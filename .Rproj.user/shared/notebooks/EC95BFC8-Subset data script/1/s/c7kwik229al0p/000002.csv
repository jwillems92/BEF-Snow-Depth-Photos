"0","# Create a vector of all unique dates"
"0","date_vec <- file_dat %>% "
"0","              group_by(Date) %>%                 # Likely a better way to do this..."
"0","              summarise(Time = first(Time)) %>%  # This summarise is just a placeholder for getting the"
"0","              ungroup() %>%                      # date vector"
"0","              pull(Date)"
"0",""
"0","# Get sunrise times for all dates"
"0","sunrise_times <- getSunlightTimes(date = date_vec, lat = 44.0639, lon = -71.2874, "
"0","                 keep = c(""sunrise""),"
"0","                 tz = ""America/New_York"") %>% "
"0","  select(date, sunrise)"
"0",""
"0","# Join sunrise times back to main exif data frame"
"0","joined_df <- left_join(file_dat, sunrise_times, by = c(""Date"" = ""date""))"
"0",""
"0","## Combine Time and Date columns into a POSIXct datetime column"
"0","## Find the difftime between time photo was taken and sunrise time"
"0","## Filter for difftime >=1 to eliminate photos taken when too dark to read stake (could tweak this)"
"0",""
"0","final_df <- joined_df %>% "
"0","  # Create datetime column for when photo was taken"
"0","  mutate(PhotoTime = as.POSIXct(paste(Date, Time), format=""%Y-%m-%d %H:%M:%S"")) %>% "
"0","  "
"0","  # Calculate time difference between when photo was taken and sunrise time of that day"
"0","  mutate(TimeAfterSunrise = as.numeric(difftime(PhotoTime, sunrise, units=""hours""))) %>% "
"0","  "
"0","  # Filter for photos taken >= 1 hour after sunrise"
"0","  filter(TimeAfterSunrise >= 1) %>% "
"0","  "
"0","  # Select only columns needed for final spreadsheet"
"0","  select(SourceFile, Date, Year, Month, Day, Time) %>% "
"0","  "
"0","  # Group by date to get only 1 photo per day"
"0","  group_by(Date) %>% "
"0","  summarise(SourceFile = first(SourceFile),"
"0","            Time = first(Time)) %>%             # This should give us just the first photo of the day"
"0","  "
"0","  # Break Date column back up into individual components for easier sorting"
"0","  mutate(Year = year(Date),"
"0","         Month = month(Date),"
"0","         Day = day(Date)) %>% "
"0","  "
"0","  # Reselect final columns wanted in order"
"0","  select(SourceFile, Year, Month, Day, Time)"
"0",""
"0","# write.csv(file = ""BEF Snow 2020 Subsetted.csv"", final_df, row.names = FALSE)"
